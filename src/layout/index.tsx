import Head from 'next/head';
import { motion } from 'framer-motion';
import { ReactQueryDevtools } from '@tanstack/react-query-devtools';
import { Box, useBreakpointValue } from '@chakra-ui/react';
import Sidebar from '~/components/sidebar/Sidebar';
import {
  adminRoutes,
  mentorRoutes,
  eoRoutes,
  unitRoutes
} from '~/utils/routes';
import Navbar from '~/components/sidebar/Navbar';

interface Props {
  title: string;
  children?: React.ReactNode;
  type: 'mentor' | 'admin' | 'unit';
  fullBg: boolean;
  isEO?: boolean;
}

export default function Layout({
  title,
  children,
  type,
  fullBg,
  isEO = false
}: Props) {
  const isLg = useBreakpointValue({ base: false, lg: true });
  const route = {
    admin: adminRoutes,
    unit: unitRoutes,
    mentor: isEO ? eoRoutes : mentorRoutes
  };

  return (
    <>
      <Head>
        <title>{title ? `${title} - KAT ITB 2023` : `KAT ITB 2023`}</title>
        {/* <meta name="description" content="Generated by create-t3-app" /> */}
        <link rel='icon' href='/favicon.ico' />
      </Head>
      {isLg ? (
        <Sidebar routes={route[type] || []} />
      ) : (
        <Navbar routes={route[type] || []} />
      )}

      <motion.div
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        transition={{ duration: 0.5 }}
      >
        <Box
          float='right'
          minHeight='100vh'
          height='100%'
          // overflow='auto'
          position='relative'
          maxHeight='100%'
          w={{ base: '100%', lg: 'calc( 100% - 298px )' }}
          maxWidth={{ base: '100%', lg: 'calc( 100% - 290px )' }}
          // overflowX={!isLg ? 'hidden' : undefined}
        >
          <Box
            m={
              !isLg
                ? '2vh 1.5rem 2vh 1.5rem'
                : fullBg
                ? '0 0 0 0'
                : '2vh 1.5rem 2vh 0'
            }
            bg='#F9F9F9'
            borderLeftRadius={25}
            borderRightRadius={fullBg ? 0 : 25}
            minHeight={fullBg ? '100vh' : undefined}
            height={fullBg ? undefined : isLg ? '96vh' : '100%'}
            px={{ base: '20px', lg: '50px' }}
            py={fullBg ? '40px' : '30px'}
            overflow='auto'
          >
            {children}
          </Box>
          {process.env.NODE_ENV !== 'production' && (
            <Box>
              <ReactQueryDevtools initialIsOpen={false} />
            </Box>
          )}
        </Box>
      </motion.div>
    </>
  );
}
